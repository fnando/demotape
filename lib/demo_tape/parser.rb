#
# DO NOT MODIFY!!!!
# This file is automatically generated by Racc 1.8.1
# from Racc grammar file "demotape.y".
#

require 'racc/parser.rb'


module DemoTape
  class Parser < Racc::Parser

module_eval(<<'...end demotape.y/module_eval...', 'demotape.y', 442)
  def parse(str, file: "<unknown>")
    @file = file
    @lexer = DemoTape::Lexer.new
    @tokens = @lexer.tokenize(str)
    @token_index = 0
    do_parse
  end

  def next_token
    token = @tokens.shift
    @current_token_index = @token_index
    @token_index += 1
    token
  end

  def make_token(type, value, index)
    line_info = @lexer.line_map[index] || {}
    token_class = case type
                  when :identifier then Token::Identifier
                  when :string then Token::String
                  when :number then Token::Number
                  when :duration then Token::Duration
                  when :regex then Token::Regex
                  when :time_unit then Token::TimeUnit
                  when :operator then Token::Operator
                  else Token::Base
                  end

    token_class.new(
      value,
      line: line_info[:line],
      column: line_info[:column],
      raw: line_info[:raw]
    )
  end

  def attach_location(command, duration_index: nil, speed_index: nil, timeout_index: nil)
    line_info = @lexer.line_map[@command_start_index] || {}
    command.line = line_info[:line]
    command.column = line_info[:column]
    command.line_content = line_info[:content]
    command.file = @file

    # Attach duration/speed/timeout specific columns if provided
    if duration_index
      duration_info = @lexer.line_map[duration_index] || {}
      command.duration_column = duration_info[:column]
    end

    if speed_index
      speed_info = @lexer.line_map[speed_index] || {}
      command.speed_column = speed_info[:column]
    end

    if timeout_index
      timeout_info = @lexer.line_map[timeout_index] || {}
      command.timeout_column = timeout_info[:column]
    end

    command
  end

  def on_error(token_id, token_value, value_stack)
    # Get line metadata from the lexer's line map
    line_info = @lexer.line_map[@current_token_index] || {}
    line_num = line_info[:line] || "?"
    col_num = line_info[:column] || 1
    line_content = line_info[:content] || ""

    token_name = token_to_str(token_id) || token_id.to_s

    error_msg = "Unexpected token #{token_name.inspect} at #{@file}:#{line_num}:#{col_num}:\n"
    error_msg += "  #{line_content}\n"
    error_msg += "  #{' ' * (col_num - 1)}^"

    raise DemoTape::ParseError, error_msg
  end

...end demotape.y/module_eval...
##### State transition tables begin ###

racc_action_table = [
    37,    21,    18,    19,    40,    20,    38,    24,    25,    34,
    24,    25,    43,     4,    44,    45,    24,    25,     6,    24,
    25,    10,     4,    12,    47,    11,    49,    34,    13,    48,
    14,    28,    31,    29,    32,     9,    15,     9,    17,    27,
    30,    33,    34,    35,    36,    50,    51,    52,    53,    54,
    55,    56,    57,    58,    59,    60 ]

racc_action_check = [
    27,    10,    10,    10,    35,    10,    35,    10,    10,    27,
    35,    35,    36,     0,    36,    37,    36,    36,     1,    37,
    37,     4,     2,     4,    38,     4,    47,    38,     5,    47,
     5,    12,    14,    12,    14,     3,     6,     7,     8,    11,
    13,    16,    19,    21,    26,    48,    49,    50,    51,    52,
    53,    54,    55,    57,    58,    59 ]

racc_action_pointer = [
     9,    18,    18,    32,    18,    25,    36,    34,    36,   nil,
    -3,    33,    27,    34,    28,   nil,    39,   nil,   nil,    30,
   nil,    40,   nil,   nil,   nil,   nil,    41,    -3,   nil,   nil,
   nil,   nil,   nil,   nil,   nil,     0,     6,     9,    15,   nil,
   nil,   nil,   nil,   nil,   nil,   nil,   nil,    23,    36,    40,
    41,    39,    40,    47,    45,    46,   nil,    44,    51,    49,
   nil ]

racc_action_default = [
    -2,   -39,    -1,    -6,   -31,    -9,   -39,    -6,   -39,    -5,
   -39,   -39,   -39,   -39,   -39,    61,   -39,    -3,    -7,   -10,
   -18,   -39,   -29,   -30,   -36,   -37,   -16,   -15,   -32,   -33,
    -8,   -34,   -35,    -4,   -38,   -39,   -39,   -39,   -26,   -25,
   -27,   -28,   -11,   -12,   -17,   -13,   -14,   -39,   -23,   -39,
   -39,   -24,   -21,   -39,   -39,   -39,   -19,   -22,   -39,   -39,
   -20 ]

racc_goto_table = [
    22,     8,     1,    23,    26,    16,     3,     2,     7,   nil,
   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,
   nil,   nil,   nil,   nil,   nil,    41,    42,    46,    39 ]

racc_goto_check = [
     7,     4,     1,     6,     6,     4,     3,     2,     3,   nil,
   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,   nil,
   nil,   nil,   nil,   nil,   nil,     7,     7,     7,     6 ]

racc_goto_pointer = [
   nil,     2,     7,     6,    -2,   nil,    -7,   -10 ]

racc_goto_default = [
   nil,   nil,   nil,   nil,   nil,     5,   nil,   nil ]

racc_reduce_table = [
  0, 0, :racc_error,
  1, 14, :_reduce_1,
  0, 14, :_reduce_2,
  3, 15, :_reduce_3,
  4, 15, :_reduce_4,
  1, 17, :_reduce_5,
  0, 17, :_reduce_6,
  3, 16, :_reduce_7,
  3, 16, :_reduce_8,
  1, 16, :_reduce_9,
  3, 16, :_reduce_10,
  5, 16, :_reduce_11,
  5, 16, :_reduce_12,
  5, 16, :_reduce_13,
  5, 16, :_reduce_14,
  3, 16, :_reduce_15,
  3, 16, :_reduce_16,
  5, 16, :_reduce_17,
  3, 16, :_reduce_18,
  11, 16, :_reduce_19,
  14, 16, :_reduce_20,
  9, 16, :_reduce_21,
  11, 16, :_reduce_22,
  7, 16, :_reduce_23,
  8, 16, :_reduce_24,
  5, 16, :_reduce_25,
  5, 16, :_reduce_26,
  5, 16, :_reduce_27,
  5, 16, :_reduce_28,
  3, 16, :_reduce_29,
  3, 16, :_reduce_30,
  1, 16, :_reduce_31,
  3, 18, :_reduce_32,
  3, 18, :_reduce_33,
  3, 18, :_reduce_34,
  3, 18, :_reduce_35,
  1, 20, :_reduce_36,
  1, 20, :_reduce_37,
  2, 19, :_reduce_38 ]

racc_reduce_n = 39

racc_shift_n = 61

racc_token_table = {
  false => 0,
  :error => 1,
  :NEWLINE => 2,
  :SPACE => 3,
  :IDENTIFIER => 4,
  :PLUS => 5,
  :NUMBER => 6,
  :AT => 7,
  :REGEX => 8,
  :COMMA => 9,
  :STRING => 10,
  :WORD => 11,
  :TIME_UNIT => 12 }

racc_nt_base = 13

racc_use_result_var = true

Racc_arg = [
  racc_action_table,
  racc_action_check,
  racc_action_default,
  racc_action_pointer,
  racc_goto_table,
  racc_goto_check,
  racc_goto_default,
  racc_goto_pointer,
  racc_nt_base,
  racc_reduce_table,
  racc_token_table,
  racc_shift_n,
  racc_reduce_n,
  racc_use_result_var ]
Ractor.make_shareable(Racc_arg) if defined?(Ractor)

Racc_token_to_s_table = [
  "$end",
  "error",
  "NEWLINE",
  "SPACE",
  "IDENTIFIER",
  "PLUS",
  "NUMBER",
  "AT",
  "REGEX",
  "COMMA",
  "STRING",
  "WORD",
  "TIME_UNIT",
  "$start",
  "tape",
  "commands",
  "command",
  "trailing_space",
  "key_combo",
  "duration",
  "string" ]
Ractor.make_shareable(Racc_token_to_s_table) if defined?(Ractor)

Racc_debug_parser = false

##### State transition tables end #####

# reduce 0 omitted

module_eval(<<'.,.,', 'demotape.y', 2)
  def _reduce_1(val, _values, result)
     result = val[0]
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 3)
  def _reduce_2(val, _values, result)
     result = []
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 5)
  def _reduce_3(val, _values, result)
     result = [val[0]]
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 6)
  def _reduce_4(val, _values, result)
     result = val[0] << val[1]
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 8)
  def _reduce_5(val, _values, result)
     result = nil
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 9)
  def _reduce_6(val, _values, result)
     result = nil
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 12)
  def _reduce_7(val, _values, result)
                 space_index = @token_index - 2
             line_info = @lexer.line_map[space_index] || {}
             error_msg = "Unexpected token \"SPACE\" at #{@file}:#{line_info[:line]}:#{line_info[:column]}:\n"
             error_msg += "  #{line_info[:content]}\n"
             error_msg += "  #{' ' * (line_info[:column] - 1)}^"
             raise DemoTape::ParseError, error_msg

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 20)
  def _reduce_8(val, _values, result)
                 @command_start_index = @last_key_index
             keys = val[0][:keys]
             key_tokens = val[0][:tokens]
             command_name = keys.shift

             tokens = key_tokens + [make_token(:number, val[2], @token_index - 1)]

             cmd = DemoTape::Command.new(command_name, "", keys:, count: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 32)
  def _reduce_9(val, _values, result)
                 @command_start_index = @last_key_index
             keys = val[0][:keys]
             key_tokens = val[0][:tokens]
             command_name = keys.shift

             cmd = DemoTape::Command.new(command_name, "", keys:)
             cmd.tokens = key_tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 42)
  def _reduce_10(val, _values, result)
                 @command_start_index = @token_index - 4
             duration_index = @token_index - 2

             tokens = [
               make_token(:identifier, val[0], @token_index - 4),
               make_token(:number, val[2], @token_index - 2)
             ]

             # Duration commands (Sleep, Wait) treat bare numbers as seconds
             # Key commands treat numbers as repeat counts
             if ["Sleep", "Wait"].include?(val[0])
               cmd = DemoTape::Command.new(val[0], "#{val[2]}s")
               cmd.tokens = tokens
               result = attach_location(cmd, duration_index: duration_index).prepare!
             else
               cmd = DemoTape::Command.new(val[0], "", count: val[2])
               cmd.tokens = tokens
               result = attach_location(cmd).prepare!
             end

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 63)
  def _reduce_11(val, _values, result)
                 @command_start_index = @token_index - 6
             speed_index = @token_index - 3  # TIME_UNIT position

             tokens = [
               make_token(:identifier, val[0], @token_index - 6),
               make_token(:operator, "@", @token_index - 5),
               make_token(:duration, val[2], @token_index - 4),
               make_token(:string, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], val[4], speed: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd, speed_index: speed_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 78)
  def _reduce_12(val, _values, result)
                 @command_start_index = @token_index - 6
             speed_index = @token_index - 3  # TIME_UNIT position

             tokens = [
               make_token(:identifier, val[0], @token_index - 6),
               make_token(:operator, "@", @token_index - 5),
               make_token(:duration, val[2], @token_index - 4),
               make_token(:number, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], "", speed: val[2], count: val[4])
             cmd.tokens = tokens
             result = attach_location(cmd, speed_index: speed_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 93)
  def _reduce_13(val, _values, result)
                 @command_start_index = @token_index - 5
             speed_index = @token_index - 3

             tokens = [
               make_token(:identifier, val[0], @token_index - 5),
               make_token(:operator, "@", @token_index - 4),
               make_token(:number, val[2], @token_index - 3),
               make_token(:number, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], "", speed: "#{val[2]}s", count: val[4])
             cmd.tokens = tokens
             result = attach_location(cmd, speed_index: speed_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 108)
  def _reduce_14(val, _values, result)
                 @command_start_index = @token_index - 5
             speed_index = @token_index - 3

             tokens = [
               make_token(:identifier, val[0], @token_index - 5),
               make_token(:operator, "@", @token_index - 4),
               make_token(:number, val[2], @token_index - 3),
               make_token(:string, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], val[4], speed: "#{val[2]}s")
             cmd.tokens = tokens
             result = attach_location(cmd, speed_index: speed_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 123)
  def _reduce_15(val, _values, result)
                 @command_start_index = @token_index - 3
             speed_index = @token_index - 1

             tokens = [
               make_token(:identifier, val[0], @token_index - 3),
               make_token(:operator, "@", @token_index - 2),
               make_token(:number, val[2], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], "", speed: "#{val[2]}s")
             cmd.tokens = tokens
             result = attach_location(cmd, speed_index: speed_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 137)
  def _reduce_16(val, _values, result)
                 @command_start_index = @token_index - 4
             speed_index = @token_index - 1  # TIME_UNIT position

             tokens = [
               make_token(:identifier, val[0], @token_index - 4),
               make_token(:operator, "@", @token_index - 3),
               make_token(:duration, val[2], @token_index - 2)
             ]

             cmd = DemoTape::Command.new(val[0], "", speed: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd, speed_index: speed_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 151)
  def _reduce_17(val, _values, result)
                 @command_start_index = @token_index - 6
             timeout_index = @token_index - 3  # TIME_UNIT position
             regex_index = @token_index - 1

             begin
               Regexp.new(val[4])
             rescue RegexpError => e
               line_info = @lexer.line_map[regex_index] || {}
               error_msg = "Invalid regex: #{e.message} at #{@file}:#{line_info[:line]}:#{line_info[:column]}:\n"
               error_msg += "  #{line_info[:content]}\n"
               error_msg += "  #{' ' * (line_info[:column] - 1)}^"
               raise DemoTape::ParseError, error_msg
             end

             tokens = [
               make_token(:identifier, val[0], @token_index - 6),
               make_token(:operator, "@", @token_index - 5),
               make_token(:duration, val[2], @token_index - 4),
               make_token(:regex, val[4], regex_index)
             ]

             cmd = DemoTape::Command.new(val[0], val[4], timeout: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd, timeout_index: timeout_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 177)
  def _reduce_18(val, _values, result)
                 @command_start_index = @token_index - 3
             regex_index = @token_index - 1

             begin
               Regexp.new(val[2])
             rescue RegexpError => e
               line_info = @lexer.line_map[regex_index] || {}
               error_msg = "Invalid regex: #{e.message} at #{@file}:#{line_info[:line]}:#{line_info[:column]}:\n"
               error_msg += "  #{line_info[:content]}\n"
               error_msg += "  #{' ' * (line_info[:column] - 1)}^"
               raise DemoTape::ParseError, error_msg
             end

             tokens = [
               make_token(:identifier, val[0], @token_index - 3),
               make_token(:regex, val[2], regex_index)
             ]

             cmd = DemoTape::Command.new(val[0], val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 200)
  def _reduce_19(val, _values, result)
                 @command_start_index = @token_index - 9

             tokens = [
               make_token(:identifier, val[0], @token_index - 9),
               make_token(:identifier, val[2], @token_index - 7),
               make_token(:number, val[4], @token_index - 5),
               make_token(:operator, ",", @token_index - 4),
               make_token(:number, val[6], @token_index - 3),
               make_token(:operator, ",", @token_index - 2),
               make_token(:number, val[8], @token_index - 1),
               make_token(:operator, ",", @token_index - 1),
               make_token(:number, val[10], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], [val[4], val[6], val[8], val[10]], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 219)
  def _reduce_20(val, _values, result)
                 @command_start_index = @token_index - 13

             tokens = [
               make_token(:identifier, val[0], @token_index - 13),
               make_token(:identifier, val[2], @token_index - 11),
               make_token(:number, val[4], @token_index - 9),
               make_token(:operator, ",", @token_index - 8),
               make_token(:number, val[7], @token_index - 6),
               make_token(:operator, ",", @token_index - 5),
               make_token(:number, val[10], @token_index - 3),
               make_token(:operator, ",", @token_index - 2),
               make_token(:number, val[13], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], [val[4], val[7], val[10], val[13]], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 238)
  def _reduce_21(val, _values, result)
                 @command_start_index = @token_index - 7

             tokens = [
               make_token(:identifier, val[0], @token_index - 7),
               make_token(:identifier, val[2], @token_index - 5),
               make_token(:number, val[4], @token_index - 3),
               make_token(:operator, ",", @token_index - 2),
               make_token(:number, val[6], @token_index - 1),
               make_token(:operator, ",", @token_index - 1),
               make_token(:number, val[8], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], [val[4], val[6], val[8]], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 255)
  def _reduce_22(val, _values, result)
                 @command_start_index = @token_index - 11

             tokens = [
               make_token(:identifier, val[0], @token_index - 11),
               make_token(:identifier, val[2], @token_index - 9),
               make_token(:number, val[4], @token_index - 7),
               make_token(:operator, ",", @token_index - 6),
               make_token(:number, val[7], @token_index - 4),
               make_token(:operator, ",", @token_index - 3),
               make_token(:number, val[10], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], [val[4], val[7], val[10]], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 272)
  def _reduce_23(val, _values, result)
                 @command_start_index = @token_index - 5

             tokens = [
               make_token(:identifier, val[0], @token_index - 5),
               make_token(:identifier, val[2], @token_index - 3),
               make_token(:number, val[4], @token_index - 1),
               make_token(:operator, ",", @token_index - 1),
               make_token(:number, val[6], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], [val[4], val[6]], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 287)
  def _reduce_24(val, _values, result)
                 @command_start_index = @token_index - 8

             tokens = [
               make_token(:identifier, val[0], @token_index - 8),
               make_token(:identifier, val[2], @token_index - 6),
               make_token(:number, val[4], @token_index - 4),
               make_token(:operator, ",", @token_index - 3),
               make_token(:number, val[7], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], [val[4], val[7]], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 302)
  def _reduce_25(val, _values, result)
                 @command_start_index = @token_index - 6

             tokens = [
               make_token(:identifier, val[0], @token_index - 6),
               make_token(:identifier, val[2], @token_index - 4),
               make_token(:duration, val[4], @token_index - 2)
             ]

             cmd = DemoTape::Command.new(val[0], val[4], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 315)
  def _reduce_26(val, _values, result)
                 @command_start_index = @token_index - 5

             tokens = [
               make_token(:identifier, val[0], @token_index - 5),
               make_token(:identifier, val[2], @token_index - 3),
               make_token(:number, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], val[4].to_s, option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 328)
  def _reduce_27(val, _values, result)
                 @command_start_index = @token_index - 5

             tokens = [
               make_token(:identifier, val[0], @token_index - 5),
               make_token(:identifier, val[2], @token_index - 3),
               make_token(:identifier, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], val[4], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 341)
  def _reduce_28(val, _values, result)
                 @command_start_index = @token_index - 5

             tokens = [
               make_token(:identifier, val[0], @token_index - 5),
               make_token(:identifier, val[2], @token_index - 3),
               make_token(:string, val[4], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], val[4], option: val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 354)
  def _reduce_29(val, _values, result)
                 @command_start_index = @token_index - 3

             tokens = [
               make_token(:identifier, val[0], @token_index - 3),
               make_token(:string, val[2], @token_index - 1)
             ]

             cmd = DemoTape::Command.new(val[0], val[2])
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 366)
  def _reduce_30(val, _values, result)
                 @command_start_index = @token_index - 4
             duration_index = @token_index - 1  # TIME_UNIT position

             tokens = [
               make_token(:identifier, val[0], @token_index - 4),
               make_token(:duration, val[2], @token_index - 2)
             ]

             cmd = DemoTape::Command.new(val[0], val[2])
             cmd.tokens = tokens
             result = attach_location(cmd, duration_index: duration_index).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 379)
  def _reduce_31(val, _values, result)
                 @command_start_index = @token_index - 2

             tokens = [make_token(:identifier, val[0], @token_index - 2)]

             cmd = DemoTape::Command.new(val[0], "")
             cmd.tokens = tokens
             result = attach_location(cmd).prepare!

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 389)
  def _reduce_32(val, _values, result)
                   @last_key_index = @token_index - 1

               tokens = [
                 make_token(:identifier, val[0], @token_index - 3),
                 make_token(:operator, "+", @token_index - 2),
                 make_token(:identifier, val[2], @token_index - 1)
               ]

               result = { keys: [val[0], val[2]], tokens: tokens }

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 400)
  def _reduce_33(val, _values, result)
                   @last_key_index = @token_index - 1

               tokens = [
                 make_token(:identifier, val[0], @token_index - 3),
                 make_token(:operator, "+", @token_index - 2),
                 make_token(:number, val[2], @token_index - 1)
               ]

               result = { keys: [val[0], val[2].to_s], tokens: tokens }

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 411)
  def _reduce_34(val, _values, result)
                   @last_key_index = @token_index - 1

               tokens = val[0][:tokens] + [
                 make_token(:operator, "+", @token_index - 2),
                 make_token(:identifier, val[2], @token_index - 1)
               ]

               result = { keys: val[0][:keys] << val[2], tokens: tokens }

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 421)
  def _reduce_35(val, _values, result)
                   @last_key_index = @token_index - 1

               tokens = val[0][:tokens] + [
                 make_token(:operator, "+", @token_index - 2),
                 make_token(:number, val[2], @token_index - 1)
               ]

               result = { keys: val[0][:keys] << val[2].to_s, tokens: tokens }

    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 431)
  def _reduce_36(val, _values, result)
     result = val[0]
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 432)
  def _reduce_37(val, _values, result)
     result = val[0]
    result
  end
.,.,

module_eval(<<'.,.,', 'demotape.y', 434)
  def _reduce_38(val, _values, result)
     result = "#{val[0]}#{val[1]}"
    result
  end
.,.,

def _reduce_none(val, _values, result)
  val[0]
end

  end   # class Parser
end   # module DemoTape


